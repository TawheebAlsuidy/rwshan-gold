{% extends 'base.html' %}
{% load i18n static %}

{% block title %}{% trans "Preview Your Design - Rwshan Gold Company" %}{% endblock %}

{% block content %}
<div class="container py-8">
    <div class="row">
        <div class="col-lg-8 mx-auto">
            <div class="configurator-steps mb-5">
                <div class="step completed">
                    <div class="step-number">1</div>
                    <div class="step-title">{% trans "Select Category" %}</div>
                </div>
                <div class="step completed">
                    <div class="step-number">2</div>
                    <div class="step-title">{% trans "Customize Design" %}</div>
                </div>
                <div class="step active">
                    <div class="step-number">3</div>
                    <div class="step-title">{% trans "Preview & Save" %}</div>
                </div>
            </div>

            <div class="card">
                <div class="card-body">
                    <h2 class="card-title">{% trans "Preview Your Design" %}</h2>
                    
                    {% if design %}
                    <div class="row">
                        <div class="col-md-6">
                            <div class="design-preview position-relative d-inline-block">
                                {% if design.ai_preview %}
                                    <img src="{{ design.ai_preview.url }}" alt="Uniform" class="uniform-img img-fluid">
                                {% endif %}

                                {% if design.logo %}
                                    <img src="{{ design.logo.url }}" alt="Logo" class="logo-overlay img-fluid">
                                {% endif %}
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="design-details">
                                <h3>{% trans "Design Details" %}</h3>
                                <table class="table">
                                    <tr>
                                        <th>{% trans "Product" %}</th>
                                        <td>{{ design.product.name }}</td>
                                    </tr>
                                    <tr>
                                        <th>{% trans "Fabric" %}</th>
                                        <td>{{ design.fabric.name }}</td>
                                    </tr>
                                    <tr>
                                        <th>{% trans "Color" %}</th>
                                        <td>{{ design.color }}</td>
                                    </tr>
                                    <tr>
                                        <th>{% trans "Logo" %}</th>
                                        <td>{% if design.logo %}{% trans "Uploaded" %}{% else %}{% trans "None" %}{% endif %}</td>
                                    </tr>
                                    <tr>
                                        <th>{% trans "Notes" %}</th>
                                        <td>{{ design.notes|default:"-" }}</td>
                                    </tr>
                                    <tr>
                                        <th>{% trans "Estimated Price" %}</th>
                                        <td>{{ design.get_total_price }} SAR</td>
                                    </tr>
                                </table>
                                
                                <div class="design-actions mt-3">
                                    <a href="{% url 'configurator:step1' %}?category={{ design.product.category.id }}" class="btn btn-outline-secondary">{% trans "Edit Design" %}</a>
                                    <!-- <a href="{% url 'quotes:calculator' %}?design={{ design.id }}" class="btn btn-primary">{% trans "Get Quote" %}</a> -->
                                    <a href="{% url 'quotes:calculator' %}?product={{ design.product.id }}&fabric={{ design.fabric.id }}&color={{ design.color.id }}&quantity=1&logo_complexity=simple" class="btn btn-primary">
                                        {% trans "Get Quote" %}
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% else %}
                    <div class="alert alert-warning">
                        {% trans "No design found. Please start over." %}
                        <a href="{% url 'configurator:start' %}" class="btn btn-primary">{% trans "Start Over" %}</a>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}